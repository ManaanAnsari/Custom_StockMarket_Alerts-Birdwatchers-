
{% load static  %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="{% static '/assets/img//apple-icon.png'%}">
  <link rel="icon" type="image/png" href="{% static '/assets/img//favicon.png'%}">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    BirdWatchers
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
  <!-- CSS Files -->
  <link href="{% static '/assets/css/bootstrap.min.css' %}" rel="stylesheet" />
  <link href="{% static '/assets/css/paper-kit.css'%}" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="{% static '/assets/demo/demo.css'%}" rel="stylesheet" />
</head>

<style>
.borderless td, .borderless th {
    border: none;
}
#search_input {
  background-position: 10px 12px; /* Position the search icon */
  background-repeat: no-repeat; /* Do not repeat the icon image */
  width: 100%; /* Full-width */
  font-size: 16px; /* Increase font-size */
  padding: 12px 20px 12px 40px; /* Add some padding */
  border: 1px solid #ddd; /* Add a grey border */
  margin-bottom: 12px; /* Add some space below the input */
}

.fetched_results {
  /* Remove default list styling */
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.fetched_results li a {
  border: 1px solid #ddd; /* Add a border to all links */
  margin-top: -1px; /* Prevent double borders */
  background-color: #f6f6f6; /* Grey background color */
  padding: 12px; /* Add some padding */
  text-decoration: none; /* Remove default text underline */
  font-size: 18px; /* Increase the font-size */
  color: black; /* Add a black text color */
  display: block; /* Make it into a block element to fill the whole list */
}

.fetched_results li a:hover:not(.header) {
  background-color: #eee; /* Add a hover effect to all links, except for headers */
}
</style>
<body class="index-page sidebar-collapse">
  {% comment %} <nav class="navbar navbar-expand-lg fixed-top  " color-on-scroll="300"> {% endcomment %}
  <nav class="navbar navbar-expand-lg fixed-top" >
    <div class="container">
      <div class="navbar-translate">
        <span class="navbar-brand mb-0 h1">BirdWatchers <small><sub>beta</sub></small></span>
        {% comment %} <a class="navbar-brand" href="#" rel="tooltip" >
          BirdWatchers <sub>beta</sub>
        </a> {% endcomment %}
        <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-bar bar1"></span>
          <span class="navbar-toggler-bar bar2"></span>
          <span class="navbar-toggler-bar bar3"></span>
        </button>
      </div>
      


      <div class="collapse navbar-collapse justify-content-end" id="navigation">
        <ul class="navbar-nav">
          {% comment %} <li class="nav-item">
            <a class="nav-link" rel="tooltip" title="Follow us on Twitter" data-placement="bottom" href="https://twitter.com/CreativeTim" target="_blank">
              <i class="fa fa-twitter"></i>
              <p class="d-lg-none">Twitter</p>
            </a>
          </li> {% endcomment %}
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" id="dropdownMenuButton" href="#pk" role="button" aria-haspopup="true" aria-expanded="false">{{user.first_name}}</a>
            <ul class="dropdown-menu dropdown-info" aria-labelledby="dropdownMenuButton">
              <li class="dropdown-header">Telegram</li>
              <a class="dropdown-item" href="/logout">LogOut</a>
              <a class="dropdown-item" href="https://www.youtube.com/watch?v=3PAn-6vkWxk" target="_blank" >Tutorials</a>
            </ul>
          </li>
          <li class="nav-item">
            <a href="#" id="upgrade_btn" class="btn btn-danger btn-round">Upgrade to Pro</a>
          </li>
          <li class="nav-item">
            {% comment %} <a  href="#" class="btn btn-info btn-round" data-toggle="modal" id="search_instrument_btn" data-target="#contact_us_modal" >Contact us</a> {% endcomment %}
            <a href="https://t.me/ManaanAnsari"  target="_blank"  class="btn btn-info btn-round">Contact us</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- End Navbar -->
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col">
          <h2>Alerts Temporarily not working</h2>
          <h3>(migrating the app from Heroku to AWS)</h3>
          <h4>for more info contact me on telegram
          <a href="https://t.me/ManaanAnsari" target="_blank" >@ManaanAnsari</a><br></h4> 
        </div>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col">
          <div class="section section-navigation">
            <div class="nav-tabs-navigation">
              <a  href="https://www.youtube.com/watch?v=3PAn-6vkWxk" target="_blank" ><h4>How to Use?</h4></a>
              <div class="nav-tabs-wrapper">
                <ul id="tabs" class="nav nav-tabs" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#home" role="tab">
                      <h3>Alerts</h3>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#profile" role="tab">
                      <h3>Watchlist</h3>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <div id="my-tab-content" class="tab-content text-center">
              <div class="tab-pane active" id="home" role="tabpanel">
                <table class="table borderless">
                  <tbody id="alerts_table">
                  {% comment %} displays alerts here {% endcomment %}
                    {% for alert in alerts %}
                      <tr>
                        {% if alert.enabled == '1' %}
                          {% if alert.name %}
                            <td><a href="/update_alert/{{alert.id}}"> <h4> {{alert.name}} {{alert.candle.name}} </h4> </a></td>
                          {% else %}
                            <td><a href="/update_alert/{{alert.id}}" > <h4> {{alert.candle.name}} </h4> </a></td>
                          {% endif %}
                          <td>
                            {% comment %} <a  href="#" class="btn btn-outline-danger btn-just-icon disable_alert_btn"><i class="fa fa-eye-slash" style="color:grey"></i></a> {% endcomment %}
                            <a  href="/disable_alert/{{alert.id}}" class="btn btn-secondary" >disable</a>
                            <input type="hidden" value="{{alert.id}}" >
                          </td>
                        {% else %}
                          {% if alert.name %}
                            <td><a href="/update_alert/{{alert.id}}"> <s><h4> {{alert.name}} {{alert.candle.name}} </h4></s> </a></td>
                          {% else %}
                            <td><a href="/update_alert/{{alert.id}}" > <s> <h4> {{alert.candle.name}}</h4></s> </a></td>
                          {% endif %}
                          <td>
                            {% comment %} <a  href="#" class="btn btn-outline-danger btn-just-icon enable_alert_btn"><i class="fa fa-eye" style="color:grey"></i></a> {% endcomment %}
                            <a  href="/enable_alert/{{alert.id}}" class="btn btn-secondary" >enable</a>
                            <input type="hidden" value="{{alert.id}}" >
                          </td>
                        {% endif %}
                        <td>
                          <a  href="#" class="btn btn-outline-danger btn-just-icon delete_alert_btn"><i class="fa fa-trash-o" style="color:red"></i></a>
                          <input type="hidden" value="{{alert.id}}" >
                        </td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
                <a  href="/create_alert/" class="btn btn-outline-info btn-just-icon"><i class="fa fa-plus"></i></a>
              </div>
              <div class="tab-pane" id="profile" role="tabpanel">
                <a  href="#" class="btn btn-outline-info btn-just-icon" data-toggle="modal" id="search_instrument_btn" data-target="#search_instrument_modal" ><i class="fa fa-plus"></i></a>
                <table class="table borderless">
                  <tbody id="watchlist_table">
                    {% for instrument in user_profile.watchlist.all  %}
                    <tr id="tr_{{instrument.id}}">
                      <td> <h5> {{instrument.name}} </h5></td>
                      <td>
                        <a  href="#" class="btn btn-outline-danger btn-just-icon delete_ins_btn"><i class="fa fa-trash-o" style="color:red"></i></a>
                        <input type="hidden" value="{{instrument.id}}" >
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% comment %} youtube video tutorial modal  {% endcomment %}
  {% comment %} <div class="modal fade bd-example-modal-lg" id="contact_us_modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-body">
          This Video Might Help
          <iframe width="560" height="315" src="https://www.youtube.com/embed/3PAn-6vkWxk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

          <br>
          <br>
        </div>
      </div>
    </div>
  </div> {% endcomment %}

  <div class="modal fade" id="search_instrument_modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <input type="text" autocomplete="off" id="search_input"  placeholder="Search">
            {% comment %} <input class="form-control" type="text" placeholder="Search"aria-label="Search">  {% endcomment %}
          <ul class = "fetched_results" id="fetched_instruments">

          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <footer class="footer footer-black  footer-white ">
    <div class="container">
      <div class="row">
        <nav class="footer-nav">
        </nav>
        <div class="credits ml-auto">
        </div>
      </div>
    </div>
  </footer>
    <!--   Core JS Files   -->
    <script src="{% static '/assets/js/core/jquery.min.js'%}" type="text/javascript"></script>
    <script src="{% static '/assets/js/core/popper.min.js'%}" type="text/javascript"></script>
    <script src="{% static '/assets/js/core/bootstrap.min.js'%}" type="text/javascript"></script>
    <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
    <script src="{% static '/assets/js/plugins/bootstrap-switch.js'%}"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="{% static '/assets/js/plugins/nouislider.min.js'%}" type="text/javascript"></script>
    <!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
    <script src="{% static '/assets/js/plugins/moment.min.js'%}"></script>
    <script src="{% static '/assets/js/plugins/bootstrap-datepicker.js'%}" type="text/javascript"></script>
    <!-- Control Center for Paper Kit: parallax effects, scripts for the example pages etc -->
    <script src="{% static '/assets/js/paper-kit.js' %}" type="text/javascript"></script>
    <script>
      $(document).ready(function() {
        
        $("#upgrade_btn").on('click', function() {
          alert("Thank you!ðŸ˜Š \n we are still on beta \n once official version is released you will be the first one to know :)")
        });

        $('.delete_alert_btn').on('click', function() {
          var alert_id = $(this).next().val();
          var whichtr = $(this).closest("tr");
          $.ajax({
            url : '/delete_alert/',
            type: "POST",
            data : {"alert_id":alert_id},
            timeout: 600000,
          }).done(function(response){
              if(response["status"] == "success"){
                console.log(response)
                whichtr.remove();
              }
          });
        });

        $('#watchlist_table').on('click','.delete_ins_btn', function() {
          var instrument_id = $(this).next().val();
          $.ajax({
            url : '/delete_instrument_from_watchlist/',
            type: "POST",
            data : {"instrument_id":instrument_id},
            timeout: 600000,
          }).done(function(response){
              if(response["status"] == "success"){
                console.log(response)
                $("#tr_"+instrument_id).remove();
              }
          });
        });

        $('#fetched_instruments').on('click', '.res', function() {
          var name = $(this).text();
          var instrument_id = $(this).next().val();
          $.ajax({
            url : '/add_instrument_to_watchlist/',
            type: "POST",
            data : {"instrument_id":instrument_id},
            timeout: 600000,
          }).done(function(response){
              if(response["status"] == "success"){
                var to_append = '<tr id="tr_'+instrument_id+'">';
                to_append +="<td> <h5> "+name+" </h5></td>";
                to_append +='<td><a  href="#" class="btn btn-outline-danger btn-just-icon delete_ins_btn"><i class="fa fa-trash-o" style="color:red"></i></a>';
                to_append +=' <input type="hidden" value='+instrument_id+' >'
                to_append +="</td></tr>";
                $( "#watchlist_table" ).append(to_append);
              }
              //console.log(response)
          });
        });

        $('#search_instrument_btn').on('click', function() {
          //clear all the previous inputs
          $('#fetched_instruments').empty();
          $('#search_input').val('');
        });

        if ($("#datetimepicker").length != 0) {
          $('#datetimepicker').datetimepicker({
            icons: {
              time: "fa fa-clock-o",
              date: "fa fa-calendar",
              up: "fa fa-chevron-up",
              down: "fa fa-chevron-down",
              previous: 'fa fa-chevron-left',
              next: 'fa fa-chevron-right',
              today: 'fa fa-screenshot',
              clear: 'fa fa-trash',
              close: 'fa fa-remove'
            }
          });
        }

        function scrollToDownload() {

          if ($('.section-download').length != 0) {
            $("html, body").animate({
              scrollTop: $('.section-download').offset().top
            }, 1000);
          }
        }

        $( "#search_input" ).keyup(function() {
          var search_term = $( "#search_input" ).val()
          if ((search_term.length % 2) == 0){
            $.ajax({
              url : '/search_instrument/',
              type: "POST",
              data : {"search_term":search_term},
              timeout: 600000,
            }).done(function(response){
                $('#fetched_instruments').empty();
                if(response["status"] == "success"){
                  fetchecd_data = JSON.parse(response['data']);
                  //console.log(fetchecd_data["fields"])
                  fetchecd_data.forEach(function (item, index) {
                    //console.log(item)
                    $( "#fetched_instruments" ).append('<li><a href="#" class="res" >'+item["fields"]["name"]+'</a> <input type= "hidden" value='+item["pk"]+'></li>');
                  });
                }
                //console.log(response)
            });
          } 
        });
      });
    </script>
</body>

</html>
